document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".website-switcher").forEach(function(t){const e=t.querySelector(".website-switcher__toggle"),n=t.querySelector(".website-switcher__dropdown");if(!e||!n)return;let i=!1,o=!1,s=0,r=0,c=0,a=0;const l=document.createElement("div");l.className="website-switcher__drag-handle",t.insertBefore(l,t.firstChild);const d=localStorage.getItem("websiteSwitcherPosition");if(d)try{const e=JSON.parse(d);window.innerWidth>=768?e.desktop&&(t.style.left=e.desktop.left,t.style.top=e.desktop.top,t.style.right="auto",t.style.bottom="auto",t.style.transform="none"):e.mobile&&(t.style.left=e.mobile.left,t.style.top=e.mobile.top,t.style.right="auto",t.style.bottom="auto",t.style.transform="none")}catch(t){}function u(){n.classList.add("is-animating-out"),e.setAttribute("aria-expanded","false"),setTimeout(function(){n.hidden=!0,n.classList.remove("is-animating-out")},200),i=!1}function h(e){if((e.target.closest(".website-switcher__dropdown")||e.target.closest(".website-switcher__toggle"))&&!e.target.closest(".website-switcher__drag-handle"))return;e.preventDefault(),o=!0,t.classList.add("is-dragging");const n="touchstart"===e.type?e.touches[0].clientX:e.clientX,l="touchstart"===e.type?e.touches[0].clientY:e.clientY;s=n,r=l;const d=t.getBoundingClientRect();c=d.left,a=d.top,i&&u()}function f(e){if(!o)return;e.preventDefault();const n="touchmove"===e.type?e.touches[0].clientX:e.clientX,i="touchmove"===e.type?e.touches[0].clientY:e.clientY;let l=c+(n-s),d=a+(i-r);const u=t.getBoundingClientRect(),h=window.innerWidth-u.width,f=window.innerHeight-u.height;l=Math.max(0,Math.min(l,h)),d=Math.max(0,Math.min(d,f)),t.style.left=l+"px",t.style.top=d+"px",t.style.right="auto",t.style.bottom="auto",t.style.transform="none"}function m(){if(!o)return;o=!1,t.classList.remove("is-dragging");const e=t.getBoundingClientRect(),n=JSON.parse(localStorage.getItem("websiteSwitcherPosition")||"{}");window.innerWidth>=768?n.desktop={left:e.left+"px",top:e.top+"px"}:n.mobile={left:e.left+"px",top:e.top+"px"},localStorage.setItem("websiteSwitcherPosition",JSON.stringify(n))}e.addEventListener("click",function(t){o||(t.stopPropagation(),i=!i,i?function(){n.hidden=!1,n.classList.add("is-animating-in"),e.setAttribute("aria-expanded","true"),setTimeout(function(){n.classList.remove("is-animating-in")},200);const t=n.querySelector(".website-switcher__link");t&&setTimeout(function(){t.focus()},100)}():u())}),t.addEventListener("mousedown",h),document.addEventListener("mousemove",f),document.addEventListener("mouseup",m),t.addEventListener("touchstart",h,{passive:!1}),document.addEventListener("touchmove",f,{passive:!1}),document.addEventListener("touchend",m),document.addEventListener("click",function(e){i&&!t.contains(e.target)&&u()}),document.addEventListener("keydown",function(t){i&&"Escape"===t.key&&(u(),e.focus())}),n.addEventListener("keydown",function(t){if(!i)return;const e=Array.from(n.querySelectorAll(".website-switcher__link")),o=e.indexOf(document.activeElement);"ArrowDown"===t.key?(t.preventDefault(),e[o<e.length-1?o+1:0].focus()):"ArrowUp"===t.key?(t.preventDefault(),e[o>0?o-1:e.length-1].focus()):"Home"===t.key?(t.preventDefault(),e[0].focus()):"End"===t.key&&(t.preventDefault(),e[e.length-1].focus())}),window.addEventListener("resize",function(){const e=t.getBoundingClientRect();if(e.right>window.innerWidth||e.bottom>window.innerHeight){const n=Math.min(e.left,window.innerWidth-e.width),i=Math.min(e.top,window.innerHeight-e.height);t.style.left=Math.max(0,n)+"px",t.style.top=Math.max(0,i)+"px"}})})});